<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../../">
  <title data-ice="title">lib/components/react-virtualized/internal/createExpandableCellRangeRenderer.js | redux-grid API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/cchamberlain/redux-grid" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createGrid">createGrid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-createConnect">createConnect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-createMapDispatchToProps">createMapDispatchToProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-createMapStateToProps">createMapStateToProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-createPropTypes">createPropTypes</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/fixed-data-table</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createGrid">createGrid</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/react-virtualized/internal</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createExpandableCellRangeRenderer">createExpandableCellRangeRenderer</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">components/react-virtualized/internal/utils</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/components/react-virtualized/internal/utils/CellSizeAndPositionManager.js~CellSizeAndPositionManager.html">CellSizeAndPositionManager</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">helpers</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/helpers/FakeObjectDataListStore.js~FakeObjectDataListStore.html">FakeObjectDataListStore</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">lib/components/react-virtualized/internal/createExpandableCellRangeRenderer.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import CellSizeAndPositionManager from &apos;./utils/CellSizeAndPositionManager&apos;

/**
 * Default implementation of cellRangeRenderer used by Grid.
 * This renderer supports cell-caching while the user is scrolling.
 */
export default function createExpandableCellRangeRenderer({ React, onResize, AutoSizer, Expander, expandRowManager, state }) {
  const { Component, PropTypes } = React
  class ExpandedArea extends Component {
    componentDidMount() {
      console.warn(&apos;EXPANDED CLIENT HEIGHT&apos;, this.container.childNodes[0].clientHeight)
    }
    render() {
      return (
        &lt;div
          ref={x =&gt; this.container=x}
          {...this.props}
        /&gt;
      )
    }
  }

  return ({ cellCache
          , cellRenderer
          , columnSizeAndPositionManager
          , columnStartIndex
          , columnStopIndex
          , horizontalOffsetAdjustment
          , isScrolling
          , rowSizeAndPositionManager
          , rowStartIndex
          , rowStopIndex
          , scrollLeft
          , scrollTop
          , verticalOffsetAdjustment
          } = {}) =&gt; {


    let expandedOffset = 0

    const expandedIndices = expandRowManager.getExpandedIndices()

    const renderedCells = []

    for (let rowIndex = rowStartIndex; rowIndex &lt;= rowStopIndex; rowIndex++) {
      let rowDatum = rowSizeAndPositionManager.getSizeAndPositionOfCell(rowIndex)

      let isExpandable = expandRowManager.isExpandable(rowIndex)
      let isExpanded = expandedIndices.includes(rowIndex)

      let expanderOffset = 0
      if(isExpandable) {
        const expanderKey = `${rowIndex}-expander`
        expanderOffset = expandRowManager.getExpanderWidth(rowIndex)
        let expander = (
          &lt;div
            key={expanderKey}
            style={ { height: rowDatum.size
                    , left: horizontalOffsetAdjustment
                    , top: rowDatum.offset + verticalOffsetAdjustment + expandedOffset
                    , width: expanderOffset
                    } }
            className={expandRowManager.getExpanderClassName(rowIndex)}
          &gt;
            &lt;Expander expanded={isExpanded} handleExpand={() =&gt; expandRowManager.onToggleExpand(rowIndex)}/&gt;
          &lt;/div&gt;
        )
        renderedCells.push(expander)
      } else {
        const expanderKey = `${rowIndex}-noexpander`
        renderedCells.push(&lt;div key={expanderKey} /&gt;)
      }


      for (let columnIndex = columnStartIndex; columnIndex &lt;= columnStopIndex; columnIndex++) {
        let columnDatum = columnSizeAndPositionManager.getSizeAndPositionOfCell(columnIndex)



        let key = `${rowIndex}-${columnIndex}`
        let renderedCell

        // Avoid re-creating cells while scrolling.
        // This can lead to the same cell being created many times and can cause performance issues for &quot;heavy&quot; cells.
        // If a scroll is in progress- cache and reuse cells.
        // This cache will be thrown away once scrolling completes.
        if (isScrolling) {
          if (!cellCache[key]) {
            cellCache[key] = cellRenderer({
              columnIndex,
              isScrolling,
              rowIndex
            })
          }
          renderedCell = cellCache[key]
        // If the user is no longer scrolling, don&apos;t cache cells.
        // This makes dynamic cell content difficult for users and would also lead to a heavier memory footprint.
        } else {
          renderedCell = cellRenderer({
            columnIndex,
            isScrolling,
            rowIndex
          })
        }

        if (renderedCell == null || renderedCell === false)
          continue

        const style = { height: rowDatum.size
                      , left: isExpandable &amp;&amp; columnIndex === 0 ? columnDatum.offset + horizontalOffsetAdjustment + expanderOffset : columnDatum.offset + horizontalOffsetAdjustment
                      , top: rowDatum.offset + verticalOffsetAdjustment + expandedOffset
                      , width: isExpandable &amp;&amp; columnIndex === 0 ? columnDatum.size - expanderOffset : columnDatum.size
                      }
        const child = (
          &lt;div
            key={key}
            className=&apos;Grid__cell&apos;
            style={style}
          &gt;
            {renderedCell}
          &lt;/div&gt;
        )

        renderedCells.push(child)
      }

      if(isExpanded) {
        const key=`${rowIndex}-expanded`
        const style = { /*height: expandRowManager.getHeight(rowIndex)
                      ,*/ left: horizontalOffsetAdjustment
                      , top: rowDatum.offset + rowDatum.size + verticalOffsetAdjustment + expandedOffset
                      , width: &apos;100%&apos;
                      }
        const content = expandRowManager.getContent(rowIndex, state)
        const expanded = (
          &lt;AutoSizer key={key} onResize={
            (dimensions, eventArgs) =&gt; {
              console.warn(&apos;attempting to resize gridSizer to&apos;, dimensions)
              onResize(dimensions)
            }
          } traverseSource={x =&gt; x.childNodes[0]} direction=&quot;up&quot;&gt;
            &lt;ExpandedArea
              style={style}
              className={expandRowManager.getClassName(rowIndex)}
            &gt;
              {expandRowManager.getContent(rowIndex, state)}
            &lt;/ExpandedArea&gt;
          &lt;/AutoSizer&gt;
        )
        renderedCells.push(expanded)
        //expandedOffset += height
      }
    }

    return renderedCells
  }


}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.7)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
